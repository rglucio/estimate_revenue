with company_info (symbol, name, sector, subsector, annual_revenue)  as (
values ('MMM', '3M', 'Industrials', 'Industrial Conglomerates',  34760000000) union all
values ('AOS', 'A. O. Smith', 'Industrials', 'Building Products',   3810000000) union all
values ('ABT', 'Abbott', 'Health Care', 'Health Care Equipment',  45030000000) union all
values ('ABBV', 'AbbVie', 'Health Care', 'Pharmaceuticals',  57820000000) union all
values ('ABMD', 'Abiomed', 'Health Care', 'Health Care Equipment',   1070000000) union all
values ('ACN', 'Accenture', 'Information Technology', 'IT Consulting & Other Services',  61590000000) union all
values ('ATVI', 'Activision Blizzard', 'Communication Services', 'Interactive Home Entertainment',   7360000000) union all
values ('ADM', 'ADM', 'Consumer Staples', 'Agricultural Products',  98710000000) union all
values ('ADBE', 'Adobe Inc.', 'Information Technology', 'Application Software',  17190000000) union all
values ('ADP', 'ADP', 'Information Technology', 'Data Processing & Outsourced Services',  16880000000) union all
values ('AAP', 'Advance Auto Parts', 'Consumer Discretionary', 'Automotive Retail',  11060000000) union all
values ('AES', 'AES Corporation', 'Utilities', 'Independent Power Producers & Energy Traders',  12330000000) union all
values ('AFL', 'Aflac', 'Financials', 'Life & Health Insurance',  20930000000) union all
values ('A', 'Agilent Technologies', 'Health Care', 'Health Care Equipment',   6660000000) union all
values ('APD', 'Air Products and Chemicals', 'Materials', 'Industrial Gases',  12700000000) union all
values ('AKAM', 'Akamai', 'Information Technology', 'Internet Services & Infrastructure',   3590000000) union all
values ('ALK', 'Alaska Air Group', 'Industrials', 'Airlines',   9070000000) union all
values ('ALB', 'Albemarle Corporation', 'Materials', 'Specialty Chemicals',   5590000000) union all
values ('ARE', 'Alexandria Real Estate Equities', 'Real Estate', 'Office REITs',   2500000000) union all
values ('ALGN', 'Align Technology', 'Health Care', 'Health Care Supplies',   3860000000) union all
values ('ALLE', 'Allegion', 'Industrials', 'Building Products',   3120000000) union all
values ('LNT', 'Alliant Energy', 'Utilities', 'Electric Utilities',   4070000000) union all
values ('ALL', 'Allstate', 'Financials', 'Property & Casualty Insurance',  50780000000) union all
values ('GOOGL', 'Alphabet Inc. (Class A)', 'Communication Services', 'Interactive Media & Services', 282110000000) union all
values ('GOOG', 'Alphabet Inc. (Class C)', 'Communication Services', 'Interactive Media & Services', 282110000000) union all
values ('MO', 'Altria', 'Consumer Staples', 'Tobacco',  20690000000) union all
values ('AMZN', 'Amazon', 'Consumer Discretionary', 'Internet & Direct Marketing Retail', 502190000000) union all
values ('AMCR', 'Amcor', 'Materials', 'Paper Packaging',  14840000000) union all
values ('AMD', 'AMD', 'Information Technology', 'Semiconductors',  22830000000) union all
values ('AEE', 'Ameren', 'Utilities', 'Multi-Utilities',   7170000000) union all
values ('AAL', 'American Airlines Group', 'Industrials', 'Airlines',  45210000000) union all
values ('AEP', 'American Electric Power', 'Utilities', 'Electric Utilities',  18820000000) union all
values ('AXP', 'American Express', 'Financials', 'Consumer Finance',  49620000000) union all
values ('AIG', 'American International Group', 'Financials', 'Property & Casualty Insurance',  59380000000) union all
values ('AMT', 'American Tower', 'Real Estate', 'Specialized REITs',  10450000000) union all
values ('AWK', 'American Water Works', 'Utilities', 'Water Utilities',   3810000000) union all
values ('AMP', 'Ameriprise Financial', 'Financials', 'Asset Management & Custody Banks',  14440000000) union all
values ('ABC', 'AmerisourceBergen', 'Health Care', 'Health Care Distributors', 238590000000) union all
values ('AME', 'Ametek', 'Industrials', 'Electrical Components & Equipment',   6030000000) union all
values ('AMGN', 'Amgen', 'Health Care', 'Biotechnology',  26330000000) union all
values ('APH', 'Amphenol', 'Information Technology', 'Electronic Components',  12410000000) union all
values ('ADI', 'Analog Devices', 'Information Technology', 'Semiconductors',  11110000000) union all
values ('ANSS', 'Ansys', 'Information Technology', 'Application Software',   2030000000) union all
values ('AON', 'Aon', 'Financials', 'Insurance Brokers',  12430000000) union all
values ('APA', 'APA Corporation', 'Energy', 'Oil & Gas Exploration & Production',  12440000000) union all
values ('AAPL', 'Apple Inc.', 'Information Technology', 'Technology Hardware, Storage & Peripherals', 394330000000) union all
values ('AMAT', 'Applied Materials', 'Information Technology', 'Semiconductor Equipment',  25160000000) union all
values ('APTV', 'Aptiv', 'Consumer Discretionary', 'Auto Parts & Equipment',  16980000000) union all
values ('ACGL', 'Arch Capital Group', 'Financials', 'Reinsurance',   8860000000) union all
values ('ANET', 'Arista Networks', 'Information Technology', 'Communications Equipment',   3930000000) union all
values ('AJG', 'Arthur J. Gallagher & Co.', 'Financials', 'Insurance Brokers',   8250000000) union all
values ('AIZ', 'Assurant', 'Financials', 'Multi-line Insurance',  10120000000) union all
values ('T', 'AT&T', 'Communication Services', 'Integrated Telecommunication Services', 155320000000) union all
values ('ATO', 'Atmos Energy', 'Utilities', 'Gas Utilities',   4200000000) union all
values ('ADSK', 'Autodesk', 'Information Technology', 'Application Software',   4740000000) union all
values ('AZO', 'AutoZone', 'Consumer Discretionary', 'Specialty Stores',  16250000000) union all
values ('AVB', 'AvalonBay Communities', 'Real Estate', 'Residential REITs',   2550000000) union all
values ('AVY', 'Avery Dennison', 'Materials', 'Paper Packaging',   9200000000) union all
values ('BKR', 'Baker Hughes', 'Energy', 'Oil & Gas Equipment & Services',  20740000000) union all
values ('BALL', 'Ball Corporation', 'Materials', 'Metal & Glass Containers',  15480000000) union all
values ('BAC', 'Bank of America', 'Financials', 'Diversified Banks',  91520000000) union all
values ('BBWI', 'Bath & Body Works, Inc.', 'Consumer Discretionary', 'Specialty Stores',   7780000000) union all
values ('BAX', 'Baxter International', 'Health Care', 'Health Care Equipment',  14740000000) union all
values ('BDX', 'Becton Dickinson', 'Health Care', 'Health Care Equipment',  18870000000) union all
values ('WRB', 'Berkley', 'Financials', 'Property & Casualty Insurance',  10730000000) union all
values ('BBY', 'Best Buy', 'Consumer Discretionary', 'Computer & Electronics Retail',  49250000000) union all
values ('BIO', 'Bio-Rad', 'Health Care', 'Life Sciences Tools & Services',   2800000000) union all
values ('TECH', 'Bio-Techne', 'Health Care', 'Life Sciences Tools & Services',   1120000000) union all
values ('BIIB', 'Biogen', 'Health Care', 'Biotechnology',  10360000000) union all
values ('BLK', 'BlackRock', 'Financials', 'Asset Management & Custody Banks',  18640000000) union all
values ('BK', 'BNY Mellon', 'Financials', 'Asset Management & Custody Banks',  16470000000) union all
values ('BA', 'Boeing', 'Industrials', 'Aerospace & Defense',  61420000000) union all
values ('BKNG', 'Booking Holdings', 'Consumer Discretionary', 'Internet & Direct Marketing Retail',  16020000000) union all
values ('BWA', 'BorgWarner', 'Consumer Discretionary', 'Auto Parts & Equipment',  15350000000) union all
values ('BXP', 'Boston Properties', 'Real Estate', 'Office REITs',   3040000000) union all
values ('BSX', 'Boston Scientific', 'Health Care', 'Health Care Equipment',  12570000000) union all
values ('BMY', 'Bristol Myers Squibb', 'Health Care', 'Health Care Distributors',  46740000000) union all
values ('AVGO', 'Broadcom Inc.', 'Information Technology', 'Semiconductors',  31680000000) union all
values ('BR', 'Broadridge Financial Solutions', 'Information Technology', 'Data Processing & Outsourced Services',   5800000000) union all
values ('BRO', 'Brown & Brown', 'Financials', 'Insurance Brokers',   3410000000) union all
values ('CHRW', 'C.H. Robinson', 'Industrials', 'Air Freight & Logistics',  26130000000) union all
values ('CDNS', 'Cadence Design Systems', 'Information Technology', 'Application Software',   3430000000) union all
values ('CZR', 'Caesars Entertainment', 'Consumer Discretionary', 'Casinos & Gaming',  10590000000) union all
values ('CPT', 'Camden Property Trust', 'Real Estate', 'Residential REITs',   1370000000) union all
values ('CPB', 'Campbell Soup Company', 'Consumer Staples', 'Packaged Foods & Meats',   8560000000) union all
values ('COF', 'Capital One', 'Financials', 'Consumer Finance',  29520000000) union all
values ('CAH', 'Cardinal Health', 'Health Care', 'Health Care Distributors', 187000000000) union all
values ('KMX', 'CarMax', 'Consumer Discretionary', 'Automotive Retail',  35040000000) union all
values ('CCL', 'Carnival', 'Consumer Discretionary', 'Hotels, Resorts & Cruise Lines',   9620000000) union all
values ('CARR', 'Carrier Global', 'Industrials', 'Building Products',  20340000000) union all
values ('CTLT', 'Catalent', 'Health Care', 'Pharmaceuticals',   4830000000) union all
values ('CAT', 'Caterpillar Inc.', 'Industrials', 'Construction Machinery & Heavy Trucks',  56630000000) union all
values ('CBOE', 'Cboe Global Markets', 'Financials', 'Financial Exchanges & Data',   3820000000) union all
values ('CBRE', 'CBRE Group', 'Real Estate', 'Real Estate Services',  31180000000) union all
values ('CDW', 'CDW', 'Information Technology', 'Technology Distributors',  22930000000) union all
values ('CE', 'Celanese', 'Materials', 'Specialty Chemicals',   9560000000) union all
values ('CNC', 'Centene Corporation', 'Health Care', 'Managed Health Care', 133310000000) union all
values ('CNP', 'CenterPoint Energy', 'Utilities', 'Multi-Utilities',   8770000000) union all
values ('CDAY', 'Ceridian', 'Information Technology', 'Application Software',   1190000000) union all
values ('CF', 'CF Industries', 'Materials', 'Fertilizers & Agricultural Chemicals',  10160000000) union all
values ('CRL', 'Charles River Laboratories', 'Health Care', 'Life Sciences Tools & Services',   3690000000) union all
values ('SCHW', 'Charles Schwab Corporation', 'Financials', 'Investment Banking & Brokerage',  19970000000) union all
values ('CHTR', 'Charter Communications', 'Communication Services', 'Cable & Satellite',  53160000000) union all
values ('CVX', 'Chevron Corporation', 'Energy', 'Integrated Oil & Gas', 206100000000) union all
values ('CMG', 'Chipotle Mexican Grill', 'Consumer Discretionary', 'Restaurants',   8410000000) union all
values ('CB', 'Chubb Limited', 'Financials', 'Property & Casualty Insurance',  40240000000) union all
values ('CHD', 'Church & Dwight', 'Consumer Staples', 'Household Products',   5300000000) union all
values ('CI', 'Cigna', 'Health Care', 'Managed Health Care', 179180000000) union all
values ('CINF', 'Cincinnati Financial', 'Financials', 'Property & Casualty Insurance',   7140000000) union all
values ('CTAS', 'Cintas', 'Industrials', 'Diversified Support Services',   8120000000) union all
values ('CSCO', 'Cisco', 'Information Technology', 'Communications Equipment',  51560000000) union all
values ('C', 'Citigroup', 'Financials', 'Diversified Banks',  71650000000) union all
values ('CFG', 'Citizens Financial Group', 'Financials', 'Regional Banks',   7220000000) union all
values ('CLX', 'Clorox', 'Consumer Staples', 'Household Products',   7110000000) union all
values ('CME', 'CME Group', 'Financials', 'Financial Exchanges & Data',   4950000000) union all
values ('CMS', 'CMS Energy', 'Utilities', 'Multi-Utilities',   8350000000) union all
values ('KO', 'The Coca-Cola Company', 'Consumer Staples', 'Soft Drinks',  42340000000) union all
values ('CTSH', 'Cognizant', 'Information Technology', 'IT Consulting & Other Services',  19250000000) union all
values ('CL', 'Colgate-Palmolive', 'Consumer Staples', 'Household Products',  17700000000) union all
values ('CMCSA', 'Comcast', 'Communication Services', 'Cable & Satellite', 121210000000) union all
values ('CMA', 'Comerica', 'Financials', 'Diversified Banks',   3260000000) union all
values ('CAG', 'Conagra Brands', 'Consumer Staples', 'Packaged Foods & Meats',  11790000000) union all
values ('COP', 'ConocoPhillips', 'Energy', 'Oil & Gas Exploration & Production',  66890000000) union all
values ('ED', 'Consolidated Edison', 'Utilities', 'Electric Utilities',  14500000000) union all
values ('STZ', 'Constellation Brands', 'Consumer Staples', 'Distillers & Vintners',   9440000000) union all
values ('CEG', 'Constellation Energy', 'Utilities', 'Multi-Utilities',  20990000000) union all
values ('COO', 'CooperCompanies', 'Health Care', 'Health Care Supplies',   3220000000) union all
values ('CPRT', 'Copart', 'Industrials', 'Diversified Support Services',   3500000000) union all
values ('GLW', 'Corning Inc.', 'Information Technology', 'Electronic Components',  14460000000) union all
values ('CTVA', 'Corteva', 'Materials', 'Fertilizers & Agricultural Chemicals',  17110000000) union all
values ('CSGP', 'CoStar Group', 'Industrials', 'Research & Consulting Services',   2120000000) union all
values ('COST', 'Costco', 'Consumer Staples', 'Hypermarkets & Super Centers', 226950000000) union all
values ('CTRA', 'Coterra', 'Energy', 'Oil & Gas Exploration & Production',   7350000000) union all
values ('CCI', 'Crown Castle', 'Real Estate', 'Specialized REITs',   6880000000) union all
values ('CSX', 'CSX', 'Industrials', 'Railroads',  14550000000) union all
values ('CMI', 'Cummins', 'Industrials', 'Industrial Machinery',  24790000000) union all
values ('CVS', 'CVS Health', 'Health Care', 'Health Care Services', 306930000000) union all
values ('DHI', 'D.R. Horton', 'Consumer Discretionary', 'Homebuilding',  31950000000) union all
values ('DHR', 'Danaher Corporation', 'Health Care', 'Health Care Equipment',  31250000000) union all
values ('DRI', 'Darden Restaurants', 'Consumer Discretionary', 'Restaurants',   9770000000) union all
values ('DVA', 'DaVita Inc.', 'Health Care', 'Health Care Facilities',  11640000000) union all
values ('DE', 'John Deere', 'Industrials', 'Agricultural & Farm Machinery',  48330000000) union all
values ('DAL', 'Delta Air Lines', 'Industrials', 'Airlines',  46620000000) union all
values ('XRAY', 'Dentsply Sirona', 'Health Care', 'Health Care Supplies',   4190000000) union all
values ('DVN', 'Devon Energy', 'Energy', 'Oil & Gas Exploration & Production',  17480000000) union all
values ('DXCM', 'Dexcom', 'Health Care', 'Health Care Equipment',   2670000000) union all
values ('FANG', 'Diamondback Energy', 'Energy', 'Oil & Gas Exploration & Production',   8640000000) union all
values ('DLR', 'Digital Realty', 'Real Estate', 'Specialized REITs',   4510000000) union all
values ('DFS', 'Discover Financial', 'Financials', 'Consumer Finance',  11180000000) union all
values ('DISH', 'Dish Network', 'Communication Services', 'Cable & Satellite',  17080000000) union all
values ('DIS', 'Disney', 'Communication Services', 'Movies & Entertainment',  81110000000) union all
values ('DG', 'Dollar General', 'Consumer Discretionary', 'General Merchandise Stores',  35350000000) union all
values ('DLTR', 'Dollar Tree', 'Consumer Discretionary', 'General Merchandise Stores',  27170000000) union all
values ('D', 'Dominion Energy', 'Utilities', 'Electric Utilities',  14930000000) union all
values ('DPZ', 'Dominos', 'Consumer Discretionary', 'Restaurants',   4490000000) union all
values ('DOV', 'Dover Corporation', 'Industrials', 'Industrial Machinery',   8360000000) union all
values ('DOW', 'Dow Inc.', 'Materials', 'Commodity Chemicals',  59410000000) union all
values ('DUK', 'Duke Energy', 'Utilities', 'Electric Utilities',  26590000000) union all
values ('DD', 'DuPont', 'Materials', 'Specialty Chemicals',  17130000000) union all
values ('DXC', 'DXC Technology', 'Information Technology', 'IT Consulting & Other Services',  15830000000) union all
values ('EMN', 'Eastman Chemical Company', 'Materials', 'Diversified Chemicals',  10910000000) union all
values ('ETN', 'Eaton Corporation', 'Industrials', 'Electrical Components & Equipment',  19780000000) union all
values ('EBAY', 'eBay', 'Consumer Discretionary', 'Internet & Direct Marketing Retail',  10020000000) union all
values ('ECL', 'Ecolab', 'Materials', 'Specialty Chemicals',  13530000000) union all
values ('EIX', 'Edison International', 'Utilities', 'Electric Utilities',  16610000000) union all
values ('EW', 'Edwards Lifesciences', 'Health Care', 'Health Care Equipment',   5350000000) union all
values ('EA', 'Electronic Arts', 'Communication Services', 'Interactive Home Entertainment',   7210000000) union all
values ('ELV', 'Elevance Health', 'Health Care', 'Managed Health Care', 153250000000) union all
values ('LLY', 'Eli Lilly and Company', 'Health Care', 'Pharmaceuticals',  29070000000) union all
values ('EMR', 'Emerson Electric', 'Industrials', 'Electrical Components & Equipment',  19220000000) union all
values ('ENPH', 'Enphase', 'Information Technology', 'Electronic Components',   2020000000) union all
values ('ETR', 'Entergy', 'Utilities', 'Electric Utilities',  12350000000) union all
values ('EOG', 'EOG Resources', 'Energy', 'Oil & Gas Exploration & Production',  26660000000) union all
values ('EPAM', 'EPAM Systems', 'Information Technology', 'IT Consulting & Other Services',   4460000000) union all
values ('EQT', 'EQT', 'Energy', 'Oil & Gas Exploration & Production',  12290000000) union all
values ('EFX', 'Equifax', 'Industrials', 'Research & Consulting Services',   5180000000) union all
values ('EQIX', 'Equinix', 'Real Estate', 'Specialized REITs',   6560000000) union all
values ('EQR', 'Equity Residential', 'Real Estate', 'Residential REITs',   2680000000) union all
values ('ESS', 'Essex Property Trust', 'Real Estate', 'Residential REITs',   1640000000) union all
values ('EL', 'The Estée Lauder Companies', 'Consumer Staples', 'Personal Products',  17740000000) union all
values ('ETSY', 'Etsy', 'Consumer Discretionary', 'Internet & Direct Marketing Retail',   2410000000) union all
values ('RE', 'Everest Re', 'Financials', 'Reinsurance',  12000000000) union all
values ('EVRG', 'Evergy', 'Utilities', 'Electric Utilities',   5410000000) union all
values ('ES', 'Eversource', 'Utilities', 'Multi-Utilities',  10960000000) union all
values ('EXC', 'Exelon', 'Utilities', 'Multi-Utilities',  37260000000) union all
values ('EXPE', 'Expedia Group', 'Consumer Discretionary', 'Internet & Direct Marketing Retail',  10670000000) union all
values ('EXPD', 'Expeditors International', 'Industrials', 'Air Freight & Logistics',  18980000000) union all
values ('EXR', 'Extra Space Storage', 'Real Estate', 'Specialized REITs',   1790000000) union all
values ('XOM', 'ExxonMobil', 'Energy', 'Integrated Oil & Gas', 354960000000) union all
values ('FFIV', 'F5, Inc.', 'Information Technology', 'Communications Equipment',   2700000000) union all
values ('FDS', 'FactSet', 'Financials', 'Financial Exchanges & Data',   1840000000) union all
values ('FAST', 'Fastenal', 'Industrials', 'Building Products',   6820000000) union all
values ('FRT', 'Federal Realty', 'Real Estate', 'Retail REITs',   1030000000) union all
values ('FDX', 'FedEx', 'Industrials', 'Air Freight & Logistics',  94750000000) union all
values ('FITB', 'Fifth Third Bank', 'Financials', 'Regional Banks',   7750000000) union all
values ('FRC', 'First Republic Bank', 'Financials', 'Regional Banks',   5690000000) union all
values ('FE', 'FirstEnergy', 'Utilities', 'Electric Utilities',  11750000000) union all
values ('FIS', 'FIS', 'Information Technology', 'Data Processing & Outsourced Services',  14390000000) union all
values ('FISV', 'Fiserv', 'Information Technology', 'Data Processing & Outsourced Services',  17010000000) union all
values ('FLT', 'Fleetcor', 'Information Technology', 'Data Processing & Outsourced Services',   3210000000) union all
values ('FMC', 'FMC Corporation', 'Materials', 'Fertilizers & Agricultural Chemicals',   5410000000) union all
values ('F', 'Ford Motor Company', 'Consumer Discretionary', 'Automobile Manufacturers', 148030000000) union all
values ('FTNT', 'Fortinet', 'Information Technology', 'Systems Software',   3820000000) union all
values ('FTV', 'Fortive', 'Industrials', 'Industrial Machinery',   5670000000) union all
values ('FBHS', 'Fortune Brands Home & Security', 'Industrials', 'Building Products',   8040000000) union all
values ('FOXA', 'Fox Corporation (Class A)', 'Communication Services', 'Movies & Entertainment',  13970000000) union all
values ('FOX', 'Fox Corporation (Class B)', 'Communication Services', 'Movies & Entertainment',  13970000000) union all
values ('BEN', 'Franklin Templeton', 'Financials', 'Asset Management & Custody Banks',   8520000000) union all
values ('FCX', 'Freeport-McMoRan', 'Materials', 'Copper',  23190000000) union all
values ('GRMN', 'Garmin', 'Consumer Discretionary', 'Consumer Electronics',   4950000000) union all
values ('IT', 'Gartner', 'Information Technology', 'IT Consulting & Other Services',   5100000000) union all
values ('GNRC', 'Generac', 'Industrials', 'Electrical Components & Equipment',   4440000000) union all
values ('GD', 'General Dynamics', 'Industrials', 'Aerospace & Defense',  38850000000) union all
values ('GE', 'General Electric', 'Industrials', 'Industrial Conglomerates',  75070000000) union all
values ('GIS', 'General Mills', 'Consumer Staples', 'Packaged Foods & Meats',  19170000000) union all
values ('GM', 'General Motors', 'Consumer Discretionary', 'Automobile Manufacturers', 147210000000) union all
values ('GPC', 'Genuine Parts Company', 'Consumer Discretionary', 'Specialty Stores',  21380000000) union all
values ('GILD', 'Gilead Sciences', 'Health Care', 'Biotechnology',  27520000000) union all
values ('GL', 'Globe Life', 'Financials', 'Life & Health Insurance',   5190000000) union all
values ('GPN', 'Global Payments', 'Information Technology', 'Data Processing & Outsourced Services',   8830000000) union all
values ('GS', 'Goldman Sachs', 'Financials', 'Investment Banking & Brokerage',  47320000000) union all
values ('HAL', 'Halliburton', 'Energy', 'Oil & Gas Equipment & Services',  18990000000) union all
values ('HIG', 'Hartford (The)', 'Financials', 'Property & Casualty Insurance',  22230000000) union all
values ('HAS', 'Hasbro', 'Consumer Discretionary', 'Leisure Products',   6190000000) union all
values ('HCA', 'HCA Healthcare', 'Health Care', 'Health Care Facilities',  59800000000) union all
values ('PEAK', 'Healthpeak', 'Real Estate', 'Health Care REITs',   1980000000) union all
values ('HSIC', 'Henry Schein', 'Health Care', 'Health Care Distributors',  12720000000) union all
values ('HSY', 'Hersheys', 'Consumer Staples', 'Packaged Foods & Meats',   9720000000) union all
values ('HES', 'Hess Corporation', 'Energy', 'Integrated Oil & Gas',  10380000000) union all
values ('HPE', 'Hewlett Packard Enterprise', 'Information Technology', 'Technology Hardware, Storage & Peripherals',  27980000000) union all
values ('HLT', 'Hilton Worldwide', 'Consumer Discretionary', 'Hotels, Resorts & Cruise Lines',   3440000000) union all
values ('HOLX', 'Hologic', 'Health Care', 'Health Care Equipment',   5230000000) union all
values ('HD', 'The Home Depot', 'Consumer Discretionary', 'Home Improvement Retail', 155240000000) union all
values ('HON', 'Honeywell', 'Industrials', 'Industrial Conglomerates',  34940000000) union all
values ('HRL', 'Hormel Foods', 'Consumer Staples', 'Packaged Foods & Meats',  12630000000) union all
values ('HST', 'Host Hotels & Resorts', 'Real Estate', 'Hotel & Resort REITs',   4300000000) union all
values ('HWM', 'Howmet Aerospace', 'Industrials', 'Aerospace & Defense',   5290000000) union all
values ('HPQ', 'HP Inc.', 'Information Technology', 'Technology Hardware, Storage & Peripherals',  64860000000) union all
values ('HUM', 'Humana', 'Health Care', 'Managed Health Care',  90510000000) union all
values ('HBAN', 'Huntington Bancshares', 'Financials', 'Regional Banks',   6800000000) union all
values ('HII', 'Huntington Ingalls Industries', 'Industrials', 'Aerospace & Defense',  10250000000) union all
values ('IBM', 'IBM', 'Information Technology', 'IT Consulting & Other Services',  60530000000) union all
values ('IEX', 'IDEX Corporation', 'Industrials', 'Industrial Machinery',   3090000000) union all
values ('IDXX', 'Idexx Laboratories', 'Health Care', 'Health Care Equipment',   3310000000) union all
values ('ITW', 'Illinois Tool Works', 'Industrials', 'Industrial Machinery',  15640000000) union all
values ('ILMN', 'Illumina', 'Health Care', 'Life Sciences Tools & Services',   4690000000) union all
values ('INCY', 'Incyte', 'Health Care', 'Biotechnology',   3320000000) union all
values ('IR', 'Ingersoll Rand', 'Industrials', 'Industrial Machinery',   5520000000) union all
values ('INTC', 'Intel', 'Information Technology', 'Semiconductors',  73390000000) union all
values ('ICE', 'Intercontinental Exchange', 'Financials', 'Financial Exchanges & Data',   7350000000) union all
values ('IP', 'International Paper', 'Materials', 'Paper Packaging',  20630000000) union all
values ('IPG', 'The Interpublic Group of Companies', 'Communication Services', 'Advertising',   9450000000) union all
values ('IFF', 'International Flavors & Fragrances', 'Materials', 'Specialty Chemicals',  12630000000) union all
values ('INTU', 'Intuit', 'Information Technology', 'Application Software',  12730000000) union all
values ('ISRG', 'Intuitive Surgical', 'Health Care', 'Health Care Equipment',   6120000000) union all
values ('IVZ', 'Invesco', 'Financials', 'Asset Management & Custody Banks',   6370000000) union all
values ('INVH', 'Invitation Homes', 'Real Estate', 'Residential REITs',   2170000000) union all
values ('IQV', 'IQVIA', 'Health Care', 'Life Sciences Tools & Services',  14310000000) union all
values ('IRM', 'Iron Mountain', 'Real Estate', 'Specialized REITs',   4830000000) union all
values ('JBHT', 'J.B. Hunt', 'Industrials', 'Trucking',  14660000000) union all
values ('JKHY', 'Jack Henry & Associates', 'Information Technology', 'Data Processing & Outsourced Services',   1940000000) union all
values ('J', 'Jacobs Solutions', 'Industrials', 'Construction & Engineering',  14630000000) union all
values ('JNJ', 'Johnson & Johnson', 'Health Care', 'Pharmaceuticals',  96040000000) union all
values ('JCI', 'Johnson Controls', 'Industrials', 'Building Products',  24970000000) union all
values ('JPM', 'JPMorgan Chase', 'Financials', 'Diversified Banks', 120590000000) union all
values ('JNPR', 'Juniper Networks', 'Information Technology', 'Communications Equipment',   5150000000) union all
values ('K', 'Kelloggs', 'Consumer Staples', 'Packaged Foods & Meats',  14580000000) union all
values ('KDP', 'Keurig Dr Pepper', 'Consumer Staples', 'Soft Drinks',  13640000000) union all
values ('KEY', 'KeyCorp', 'Financials', 'Regional Banks',   7060000000) union all
values ('KEYS', 'Keysight', 'Information Technology', 'Electronic Equipment & Instruments',   5270000000) union all
values ('KMB', 'Kimberly-Clark', 'Consumer Staples', 'Household Products',  20180000000) union all
values ('KIM', 'Kimco Realty', 'Real Estate', 'Retail REITs',   1650000000) union all
values ('KMI', 'Kinder Morgan', 'Energy', 'Oil & Gas Storage & Transportation',  19050000000) union all
values ('KLAC', 'KLA Corporation', 'Information Technology', 'Semiconductor Equipment',   9850000000) union all
values ('KHC', 'Kraft Heinz', 'Consumer Staples', 'Packaged Foods & Meats',  25630000000) union all
values ('KR', 'Kroger', 'Consumer Staples', 'Food Retail', 144150000000) union all
values ('LHX', 'L3Harris', 'Industrials', 'Aerospace & Defense',  16820000000) union all
values ('LH', 'LabCorp', 'Health Care', 'Health Care Services',  15720000000) union all
values ('LRCX', 'Lam Research', 'Information Technology', 'Semiconductor Equipment',  18000000000) union all
values ('LW', 'Lamb Weston', 'Consumer Staples', 'Packaged Foods & Meats',   4240000000) union all
values ('LVS', 'Las Vegas Sands', 'Consumer Discretionary', 'Casinos & Gaming',   4000000000) union all
values ('LDOS', 'Leidos', 'Industrials', 'Diversified Support Services',  14070000000) union all
values ('LEN', 'Lennar', 'Consumer Discretionary', 'Homebuilding',  31930000000) union all
values ('LNC', 'Lincoln Financial', 'Financials', 'Multi-line Insurance',  19630000000) union all
values ('LIN', 'Linde plc', 'Materials', 'Industrial Gases',  32630000000) 
)
,
-- creating dummy columns for sector field
dummy_cols_example as (
select a.*,
		case
			when sector = 'Communication Services' then 1
			else 0	
		end as comm_services,
		case
			when sector = 'Energy' then 1
			else 0	
		end as energy,
		case
			when sector = 'Information Technology' then 1
			else 0	
		end as info_tech,
		case
			when sector = 'Health Care' then 1
			else 0	
		end as health_care,
		case
			when sector = 'Real Estate' then 1
			else 0	
		end as real_estate,
		case
			when sector = 'Utilities' then 1
			else 0	
		end as utilities,
		case
			when sector = 'Financials' then 1
			else 0	
		end as financials,
		case
			when sector = 'Consumer Discretionary' then 1
			else 0	
		end as cons_discr,
		case
			when sector = 'Materials' then 1
			else 0	
		end as materials,
		case
			when sector = 'Consumer Staples' then 1
			else 0	
		end as cons_stapl,
		case
			when sector = 'Industrials' then 1
			else 0	
		end as indus
from	company_info a 
)
/*
 -- taking a look at correlation between sectors and revenue
select 	
		corr(annual_revenue, comm_services) comm_services_corr,
		corr(annual_revenue, energy) energy_corr,
		corr(annual_revenue, info_tech) info_tech_corr,
		corr(annual_revenue, health_care) health_care_corr,
		corr(annual_revenue, real_estate) real_estate_corr,
		corr(annual_revenue, utilities) utilities_corr,
		corr(annual_revenue, financials) financials_corr,
		corr(annual_revenue, cons_discr) cons_discr_corr,
		corr(annual_revenue, materials) materials_corr,
		corr(annual_revenue, cons_stapl) cons_stapl_corr,
		corr(annual_revenue, indus) industrials_corr
from dummy_cols_example
*/
,
-- getting linear model coefficientsi
model_coefficients as (
select 	regr_intercept(revenue, comm_services) comm_services_int,
		regr_intercept(revenue, energy) energy_int,
		regr_intercept(revenue, info_tech) info_tech_int,
		regr_intercept(revenue, health_care) health_care_int,
		regr_intercept(revenue, real_estate) real_estate_int,
		regr_intercept(revenue, utilities) utilities_int,
		regr_intercept(revenue, financials) financials_int,
		regr_intercept(revenue, cons_discr) cons_discr_int,
		regr_intercept(revenue, materials) materials_int,
		regr_intercept(revenue, cons_stapl) cons_stapl_int,
		regr_intercept(revenue, indus) industrials_int
from 	dummy_cols_example
)
,
-- getting a sample of records and joining to the model coefficiencts
simple_model as (
SELECT a.*,
		b.*
-- sample 10% of records
FROM dummy_cols_example a TABLESAMPLE BERNOULLI(10)  
	cross join model_coefficients b
)
-- executing model
select 	name,
		sector, 
		subsector,
		revenue,
		comm_services_int*comm_services + energy*energy_int + info_tech*info_tech_int + health_care*health_care_int + real_estate*real_estate_int + utilities*utilities_int + financials*financials_int + cons_discr*cons_discr_int + materials*materials_int + cons_stapl*cons_stapl_int + indus*industrials_int as estimated_revenue
from 	simple_model
 